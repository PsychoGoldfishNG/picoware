var _Manifests={levels:{dingus:{},psychogoldfish:{}},microgames:{dingus:{},psychogoldfish:{push_the_button:{name:"Push the Button",sceneClass:"microgames.psychogoldfish.push_the_button",jsFiles:["push-the-button.js"],atlases:[{key:"gameSprites",texture:"gameSprites.png",atlas:"gameSprites.json"}],credits:[{credit:"designer",name:"PsychoGoldfish"}]},"thwomp-stomp":{name:"Thwomp Stomp",sceneClass:"microgames.psychogoldfish.thwomp_stomp",parent:{team:"psychogoldfish",name:"push_the_button"},jsFiles:["thwomp-stomp.js"],atlases:[{key:"gameSprites",texture:"gameSprites.png",atlas:"gameSprites.json"}],credits:[{credit:"designer",name:"PsychoGoldfish"}]}}},bossgames:{dingus:{},psychogoldfish:{space_face:{name:"Space Face",sceneClass:"bossgames.psychogoldfish.space_face",jsFiles:["space-face.js"],atlases:[{key:"gameSprites",texture:"gameSprites.png",atlas:"gameSprites.json"}],credits:[{credit:"designer",name:"PsychoGoldfish"}]}}},transitions:{dingus:{},psychogoldfish:{emojis:{name:"Emojis",sceneClass:"transitions.psychogoldfish.emojis",jsFiles:["emojis.js"],spritesheets:[{key:"numberStrip",image:"numberStrip.png",frameWidth:90,frameHeight:140},{key:"hearts",image:"hearts.png",frameWidth:120,frameHeight:120},{key:"levelPhrases",image:"levelPhrases.png",frameWidth:500,frameHeight:80}],images:[{key:"happyface",image:"happyface.png"},{key:"catface",image:"catface.png"},{key:"angryface",image:"angryface.png"},{key:"sadface",image:"sadface.png"},{key:"evilface",image:"evilface.png"},{key:"brickhole",image:"brickhole.png"},{key:"gameOver",image:"gameOver.png"}],credits:[{credit:"designer",name:"PsychoGoldfish"}]}}}};function loaderScript(s){"use strict";return new Promise(function(A,e){let t=document.createElement("script");t.type="text/javascript",t.async=!0,t.addEventListener("error",e),t.addEventListener("load",A),t.src=s,document.head.appendChild(t)})}function containsAny(A,e){"use strict";for(var t=0;t!=e.length;t++){var s=e[t];if(-1!=A.indexOf(s))return s}return null}var __safariSoundHack=(()=>{"use strict";let t=document.createElement("audio");return document.body.appendChild(t),t.src="data:audio/x-wav;base64,UklGRooWAABXQVZFZm10IBAAAAABAAEAIlYAAESsAAACABAAZGF0YWYWAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",(A,e)=>{t.onended=()=>{e?A.call(e):A()},t.play()}})();const BrowserHelper={isMobile:function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)||/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.platform)},isIOS:function(){return this.isMobile()&&this.isSafari()},isSafari:function(){return-1<navigator.userAgent.indexOf("Safari")}},GameWrapper={VIEW_GAME:"game",view:"game",screenSize:524,layoutDesktop:{baseWidth:960,baseHeight:540,screenTop:8,characterFrameWidth:320,characterFrameHeight:580,characterWidth:160,characterHeight:290,logoWidth:320,logoHeight:180},layoutGBC:{baseWidth:720,baseHeight:1280,screenTop:64,screenFrameWidth:662,screenFrameHeight:714,screenFrameTop:29,mainButtonFrameTop:775,mainButtonFrameHeight:212,mainButtonSize:140,mainButtonMargin:-7,smallButtonFrameTop:1058,smallButtonWidth:212,smallButtonHeight:55,smallButtonSize:92,inputMarginX:40,dPadSize:192,dPadDeadzone:10,AbButtonWidth:239,AbButtonHeight:162,speakerWidth:154,speakerHeight:162},layoutGBA:{baseWidth:1280,baseHeight:720,screenTop:52,screenFrameWidth:654,screenFrameHeight:666,screenFrameTop:18,inputWidth:261,inputMarginX:46,inputTop:158,topInputHeight:236,bottomInputHeight:243,dPadSize:192,dPadDeadzone:10,AbButtonWidth:239,AbButtonHeight:162,mainButtonSize:140,mainButtonMargin:-7,smallButtonWidth:193,smallButtonHeight:144,smallButtonSize:59,smallButtonLeft:129,startButtonTop:17,selectButtonTop:81,ledTop:89,ledSize:56,speakerWidth:167,speakerHeight:134},gameTimerFrames:16,gameTimerSteps:8,gameTimerFlickerFrames:2,gameTimerFlickerFrame:0,gameTimerStep:0,gameTimerWidth:0,gameTimerHeight:0,gameTimerInterval:null,getOffset:function(A){for(var e={top:0,left:0};isNaN(A.offsetLeft)||(e.left+=A.offsetLeft),isNaN(A.offsetTop)||(e.top+=A.offsetTop),A=A.offsetParent;);return e},init:function(A){var l=this;function c(A,e){return l.inputs[A].touch===e.identifier&&(l.inputs[A].touch=!1,"dpad"==A?(l.ui.up=!1,l.ui.down=!1,l.ui.left=!1,l.ui.right=!1,l.dPadHighlight.style.display="none"):(e=A.toLowerCase()+"Button",l[e].style.display="none",l.ui[A]=!1,["A","B"].includes(A)&&(l.ui.action=!1),"start"===A&&(l.ui.pause=!1)),l.onInputChanged.call(l.onInputChangedThisArg,l.ui),1)}function e(A){for(var e=0;e<A.changedTouches.length;e++){var t=A.changedTouches[e];if("touchcancel"==A.type||"touchend"==A.type)for(var[s,a]of Object.entries(l.inputs))c(s,t)&&A.preventDefault();else for(var[i,n]of Object.entries(l.inputs)){var r=Math.abs(t.clientX-n.x),o=Math.abs(t.clientY-n.y),h=n.size/2,m=9999;r<=h&&o<=h&&(m=Math.sqrt(r*r+o*o)),"dpad"===i&&m<n.deadzone||h<m?c(i,t)&&A.preventDefault:function(s,a){if("dpad"==s){l.inputs[s].touch=a.identifier;let A=0;for(var[i,n]of Object.entries(l.dirval))l.ui[i]&&(A+=n);l.ui.up=!1,l.ui.down=!1,l.ui.left=!1,l.ui.right=!1;let e=[];var r=Math.atan2(a.clientY-l.inputs.dpad.y,a.clientX-l.inputs.dpad.x)*l.rad2deg;-150<=r&&r<=-30?e.push("up"):r<=150&&30<=r&&e.push("down"),-60<=r&&r<=60?e.push("right"):(120<=r||r<=-120)&&e.push("left");let t=0;if(e.forEach(A=>{l.ui[A]=!0,t+=l.dirval[A]}),t===A)return;l.dPadHighlight.style.display="block",l.dPadHighlight.setAttribute("class",e.join("-"))}else{if(l.inputs[s].touch===a.identifier)return;l.inputs[s].touch=a.identifier;a=s.toLowerCase()+"Button";l[a].style.display="block",l.ui[s]=!0,["A","B"].includes(s)&&(l.ui.action=!0),"start"===s&&(l.ui.pause=!0)}return l.onInputChanged.call(l.onInputChangedThisArg,l.ui),1}(i,t)&&A.preventDefault}}}this.viewport=document.getElementById("viewport"),this.fader=document.getElementById("fader"),this.loadingSkin=document.getElementById("loading-skin"),this.loaderBar=document.getElementById("loader-bar"),this.gameplaySkin=document.getElementById("gameplay-skin"),this.uiElements=document.getElementById("ui-elements"),this.screenframe=document.getElementById("screenframe"),this.screen=document.getElementById("screen"),this.screenTransition=document.getElementById("screenTransition"),this.led=document.getElementById("led"),this.dPadFrame=document.getElementById("dpad-frame"),this.dPad=document.getElementById("dpad"),this.dPadHighlight=document.getElementById("dpad-highlight"),this.AbButtonsFrame=document.getElementById("ab-buttons-frame"),this.AbButtons=document.getElementById("ab-buttons"),this.aButton=document.getElementById("a-button"),this.bButton=document.getElementById("b-button"),this.startSelectButtonsFrame=document.getElementById("start-select-buttons-frame"),this.startSelectButtons=document.getElementById("start-select-buttons"),this.startButton=document.getElementById("start-button"),this.selectButton=document.getElementById("select-button"),this.speakerFrame=document.getElementById("speaker-frame"),this.speaker=document.getElementById("speaker"),this.character=document.getElementById("character"),this.logo=document.getElementById("logo"),this.screenHint=document.getElementById("screenHint"),this.hintText=document.getElementById("hintText"),this.hintShadow=document.getElementById("hintShadow"),this.hintControls=document.getElementById("hintControls"),this.hintControlsInner=document.getElementById("hintControlsInner"),this.gameTimer=document.getElementById("gameTimer"),this.gameTimeOver=document.getElementById("gameTimeOver"),this.rad2deg=180/Math.PI,this.dirval={up:1,down:2,left:4,right:8},this.ui={up:!1,right:!1,down:!1,left:!1,A:!1,B:!1,select:!1,start:!1,action:!1,pause:!1},this.inputs={dpad:{x:0,y:0,size:0,touch:!1,deadzone:0},A:{x:0,y:0,size:0,touch:!1},B:{x:0,y:0,size:0,touch:!1},select:{x:0,y:0,size:0,touch:!1},start:{x:0,y:0,size:0,touch:!1},action:{x:0,y:0,size:0,touch:!1},pause:{x:0,y:0,size:0,touch:!1}},window.addEventListener("resize",()=>{setTimeout(()=>{GameWrapper.updateGameScreenOrientation()},500)}),document.body.onclick=function(A){A.preventDefault()},document.ontouchstart=e,document.ontouchmove=e,document.ontouchend=e,document.ontouchcancel=e,this.onScreenUpdated=void 0!==A.onScreenUpdated?A.onScreenUpdated:function(A){},this.onScreenUpdatedThisArg=void 0!==A.onScreenUpdatedThisArg?A.onScreenUpdatedThisArg:this,this.onInputChanged=void 0!==A.onInputChanged?A.onInputChanged:function(A,e){},this.onInputChangedThisArg=void 0!==A.onInputChangedThisArg?A.onInputChangedThisArg:this,this.updateGameScreenOrientation()},resetGameElements:function(){document.body.setAttribute("class",""),this.uiElements.setAttribute("style",""),this.screenframe.setAttribute("style",""),this.gameplaySkin.setAttribute("class","gameplay-skin"),this.screen.setAttribute("style",""),this.led.setAttribute("style",""),this.dPadFrame.setAttribute("style",""),this.dPad.setAttribute("style",""),this.dPadHighlight.setAttribute("style","display:none"),this.AbButtonsFrame.setAttribute("style",""),this.AbButtons.setAttribute("style",""),this.aButton.setAttribute("style","display:none"),this.bButton.setAttribute("style","display:none"),this.startSelectButtonsFrame.setAttribute("style",""),this.startSelectButtons.setAttribute("style",""),this.startButton.setAttribute("style","display:none"),this.selectButton.setAttribute("style","display:none"),this.speakerFrame.setAttribute("style",""),this.speaker.setAttribute("style","")},viewGameMobileLandscape:function(A){this.resetGameElements(A);var e=this.layoutGBA,t=A.ew/e.baseWidth,s=A.eh/e.baseHeight,a=t<s?t:s;1.3<=a?document.body.setAttribute("class","zoom-1-3"):a<=.7?document.body.setAttribute("class","zoom-0-5"):a<=.9&&document.body.setAttribute("class","zoom-0-8");var i=2*Math.round(e.baseWidth*a/2),n=2*Math.round(e.baseHeight*a/2),r=(A.ew-i)/2,o=(A.eh-n)/2;this.gameplaySkin.style.width=i+"px",this.gameplaySkin.style.height=n+"px",this.gameplaySkin.style.top=o+"px",this.gameplaySkin.style.left=r+"px";var h=Math.ceil(e.screenFrameWidth*a),m=Math.ceil(e.screenFrameHeight*a),l=Math.round((i-h)/2),c=Math.round((n-m)*(e.screenFrameTop/(e.baseHeight-e.screenFrameHeight)));this.screenframe.style.width=h+"px",this.screenframe.style.height=m+"px",this.screenframe.style.top=c+"px",this.screenframe.style.left=l+"px";let d={size:2*Math.round(this.screenSize*a/2)};d.top=o+Math.round(e.screenTop*a),d.left=Math.round((A.ew-d.size)/2),this.screen.style.width=this.screen.style.height=d.size+"px",this.screen.style.top=d.top+"px",this.screen.style.left=d.left+"px";var u=Math.round(e.inputTop*a),p=Math.round(e.topInputHeight*a),g=Math.round(e.bottomInputHeight*a),f=Math.round(e.inputWidth*a),y=Math.round(e.dPadSize*a),S=Math.round(e.inputMarginX*a),M=Math.round(e.smallButtonWidth*a),v=Math.round(e.smallButtonHeight*a),b=Math.round(e.smallButtonSize*a),T=Math.round(e.smallButtonLeft*a),w=Math.round(e.mainButtonSize*a),P=Math.round(e.mainButtonMargin*a),t=Math.round(e.startButtonTop*a),s=Math.round(e.selectButtonTop*a),i=Math.round(e.AbButtonWidth*a),n=Math.round(e.AbButtonHeight*a),m=Math.round(e.ledTop*a),c=Math.round(e.ledSize*a);this.dPadFrame.style.width=this.AbButtonsFrame.style.width=this.startSelectButtonsFrame.style.width=this.speakerFrame.style.width=f+"px",this.dPadFrame.style.height=this.AbButtonsFrame.style.height=p+"px",this.startSelectButtonsFrame.style.height=this.speakerFrame.style.height=g+"px",this.dPadFrame.style.top=this.AbButtonsFrame.style.top=u+"px",this.startSelectButtonsFrame.style.top=this.speakerFrame.style.top=u+p+"px",this.dPadFrame.style.left=this.startSelectButtonsFrame.style.left=S+"px",this.AbButtonsFrame.style.right=this.speakerFrame.style.right=S+"px",this.dPad.style.width=this.dPad.style.height=y+"px",this.led.style.width=this.led.style.height=c+"px",this.led.style.left=l+h+"px",this.led.style.top=m+"px",this.AbButtons.style.width=i+"px",this.AbButtons.style.height=n+"px",this.aButton.style.width=this.aButton.style.height=this.bButton.style.width=this.bButton.style.height=w+"px",this.aButton.style.top=this.aButton.style.right=this.bButton.style.bottom=this.bButton.style.left=P+"px",this.startSelectButtons.style.width=M+"px",this.startSelectButtons.style.height=v+"px",this.startButton.style.width=this.startButton.style.height=this.selectButton.style.width=this.selectButton.style.height=b+"px",this.startButton.style.left=this.selectButton.style.left=T+"px",this.startButton.style.top=t+"px",this.selectButton.style.top=s+"px",this.speaker.style.width=Math.round(e.speakerWidth*a)+"px",this.speaker.style.height=Math.round(e.speakerHeight*a)+"px",this.inputs.dpad.x=S+f/2+r,this.inputs.dpad.y=u+p/2+o,this.inputs.dpad.size=y,this.inputs.dpad.deadzone=Math.floor(e.dPadDeadzone*a),this.inputs.start.x=S+T+(b+f-M)/2+r,this.inputs.start.y=u+p+t+(b+g-v)/2+o,this.inputs.start.size=b,this.inputs.select.x=S+T+(b+f-M)/2+r,this.inputs.select.y=u+p+s+(b+g-v)/2+o,this.inputs.select.size=b,this.inputs.A.x=A.ew-S-(w+f-i)/2-r,this.inputs.A.y=u+(w+p-n)/2+o,this.inputs.A.size=w,this.inputs.B.x=A.ew-S-f+(w+f-i)/2-r,this.inputs.B.y=u+p-(w+p-n)/2+o,this.inputs.B.size=w,this.onScreenUpdated.call(this.onScreenUpdatedThisArg,d),this.updateGameTimerElement(d.size)},viewGameMobilePortrait:function(A){this.resetGameElements(A);var e=this.layoutGBC,t=A.ew/e.baseWidth,s=A.eh/e.baseHeight,a=t<s?t:s;1.3<=a?document.body.setAttribute("class","zoom-1-3"):a<=.7?document.body.setAttribute("class","zoom-0-5"):a<=.9&&document.body.setAttribute("class","zoom-0-8");var i=2*Math.round(e.baseWidth*a/2),n=2*Math.round(e.baseHeight*a/2),r=(A.ew-i)/2,o=(A.eh-n)/2;this.gameplaySkin.style.width=i+"px",this.gameplaySkin.style.height=n+"px",this.gameplaySkin.style.top=o+"px",this.gameplaySkin.style.left=r+"px";var h=Math.ceil(e.screenFrameWidth*a),m=Math.ceil(e.screenFrameHeight*a),l=Math.round((i-h)/2),c=Math.round((n-m)*(e.screenFrameTop/(e.baseHeight-e.screenFrameHeight)));this.screenframe.style.width=h+"px",this.screenframe.style.height=m+"px",this.screenframe.style.top=c+"px",this.screenframe.style.left=l+"px";let d={size:2*Math.round(this.screenSize*a/2)};d.top=o+Math.round(e.screenTop*a),d.left=Math.round((A.ew-d.size)/2),this.screen.style.width=this.screen.style.height=d.size+"px",this.screen.style.top=d.top+"px",this.screen.style.left=d.left+"px";var u=Math.round(e.mainButtonFrameTop*a),p=Math.round(e.mainButtonFrameHeight*a),g=Math.round(e.mainButtonMargin*a),f=Math.round(e.mainButtonSize*a),y=(Math.round(e.smallButtonTop*a),Math.round(e.inputMarginX*a)),S=Math.round(e.dPadSize*a),t=(Math.round(e.dPadDeadzone*a),Math.round(e.AbButtonWidth*a)),s=Math.round(e.AbButtonHeight*a),i=Math.round(e.smallButtonFrameTop*a),n=Math.round(e.smallButtonWidth*a),h=Math.round(e.smallButtonHeight*a),m=Math.round(e.smallButtonSize*a),c=Math.round(e.speakerWidth*a),l=Math.round(e.speakerHeight*a);this.dPadFrame.style.top=this.AbButtonsFrame.style.top=u+"px",this.dPadFrame.style.height=this.AbButtonsFrame.style.height=p+"px",this.dPadFrame.style.left=y+"px",this.AbButtonsFrame.style.right=y+"px",this.dPad.style.width=this.dPad.style.height=S+"px",this.AbButtons.style.width=t+"px",this.AbButtons.style.height=s+"px",this.startSelectButtonsFrame.style.top=this.speakerFrame.style.top=i+"px",this.startSelectButtons.style.width=n+"px",this.startSelectButtons.style.height=h+"px",this.startButton.style.top=this.selectButton.style.top=(h-m)/2+"px",this.startButton.style.width=this.startButton.style.height=this.selectButton.style.width=this.selectButton.style.height=m+"px",this.startButton.style.right=this.selectButton.style.left="0px",this.speaker.style.width=c+"px",this.speaker.style.height=l+"px",this.speaker.style.right=y+"px",this.inputs.dpad.x=y+S/2+r,this.inputs.dpad.y=u+p/2+o,this.inputs.dpad.size=S,this.inputs.dpad.deadzone=Math.floor(e.dPadDeadzone*a),this.inputs.select.x=(A.ew-n+m)/2,this.inputs.select.y=i+h/2+o,this.inputs.select.size=m,this.inputs.start.x=(A.ew+n-m)/2,this.inputs.start.y=i+h/2+o,this.inputs.start.size=m,this.inputs.A.x=A.ew-y-g-f/2-r,this.inputs.A.y=u+g+(p-s+f)/2+o,this.inputs.A.size=f,this.inputs.B.x=A.ew-y-t+g+f/2-r,this.inputs.B.y=u+p-g-(p-s+f)/2+o,this.inputs.B.size=f,this.aButton.style.width=this.aButton.style.height=this.bButton.style.width=this.bButton.style.height=f+"px",this.aButton.style.top=this.aButton.style.right=this.bButton.style.bottom=this.bButton.style.left=g+"px",this.onScreenUpdated.call(this.onScreenUpdatedThisArg,d),this.updateGameTimerElement(d.size)},viewGameDesktop:function(A){this.resetGameElements(A);var e=this.layoutDesktop,t=A.ew/e.baseWidth,s=A.eh/e.baseHeight,a=t<s?t:s,i=2*Math.round(e.baseWidth*a/2),n=2*Math.round(e.baseHeight*a/2),t=(A.ew-i)/2,s=(A.eh-n)/2;this.gameplaySkin.style.width=i+"px",this.gameplaySkin.style.height=n+"px",this.gameplaySkin.style.top=s+"px",this.gameplaySkin.style.left=t+"px";let r={size:2*Math.round(this.screenSize*a/2)};r.top=s+Math.round(e.screenTop*a),r.left=Math.round((A.ew-r.size)/2),this.screen.style.width=this.screen.style.height=r.size+"px",this.screen.style.top=r.top+"px",this.screen.style.left=r.left+"px";t=Math.round(e.characterWidth*a),s=Math.round(e.characterHeight*a),A=t/e.characterFrameWidth;this.character.style.width=t+"px",this.character.style.height=s+"px",this.character.style.position="absolute",this.character.style.bottom=Math.round(32*a)+"px",this.character.style.right=Math.round(32*a)+"px";s=Math.round(e.logoWidth*A),e=Math.round(e.logoHeight*A);this.logo.style.width=s+"px",this.logo.style.height=e+"px",this.logo.style.position="absolute",this.logo.style.top=Math.round(32*a)+"px",this.logo.style.left=Math.round(32*a)+"px",this.onScreenUpdated.call(this.onScreenUpdatedThisArg,r),this.updateGameTimerElement(r.size),this.setCharacterScale(A),this.setLogoScale(A)},updateGameTimerElement(A=0){let e=1048,t=160,s=240,a=240;A/=e;this.gameTimerWidth=Math.floor(e*A),this.gameTimerHeight=Math.floor(t*A),this.gameTimer.style.width=this.gameTimerWidth+"px",this.gameTimer.style.height=this.gameTimerHeight+"px",this.gameTimeOver.style.width=Math.floor(s*A)+"px",this.gameTimeOver.style.height=Math.floor(a*A)+"px",this.gameTimer.style.backgroundSize=this.gameTimerWidth+"px "+this.gameTimerHeight*this.gameTimerFrames+"px",this.updateGameTimerFrame()},startGameTimerFlicker(){let A=this;this.gameTimerInterval||(this.gameTimerInterval=setInterval(()=>{A.gameTimerFlickerFrame++,A.gameTimerFlickerFrame>=A.gameTimerFlickerFrames&&(A.gameTimerFlickerFrame=0),A.updateGameTimerFrame()},100))},startGameTimer(){this.startGameTimerFlicker(),this.gameTimerStep=0,this.gameTimer.style.display="",this.gameTimeOver.style.display="none"},stopGameTimer(){let A=this;this.stopGameTimerFlicker(),this.gameTimer.style.display="none",this.gameTimeOver.style.display="",setTimeout(()=>{A.gameTimeOver.style.display="none"},500)},stopGameTimerFlicker(){this.gameTimerInterval&&clearInterval(this.gameTimerInterval),this.gameTimerInterval=null},updateGameTimerFrame(){frame=this.gameTimerStep*this.gameTimerFlickerFrames+this.gameTimerFlickerFrame,this.gameTimer.style.backgroundPosition="0px -"+this.gameTimerHeight*frame+"px"},showLoadScreen(){this.loadingSkin.style.display=""},setLoadedValue(A){this.loaderBar.style.width=Math.round(100*A)+"%"},hideLoadScreen(){this.loadingSkin.style.display="none"},fadeIn(){this.fader.style.opacity="0"},fadeOut(){this.fader.style.opacity="1"},crossFade(A,e){this.fadeOut(),setTimeout(()=>{this.fadeIn(),A&&A(),e&&setTimeout(()=>{e()},500)},500)},setHintText:function(A,e,t,s){e=PWGame.input.getControlHint(e);var a=["wasd","arrows","gamepad","mouse","touch"].indexOf(e);let i=this;e=parseInt(this.screen.style.width.replace("px",""))/this.screenSize;let n=Math.round(210*e),r=Math.round(100*e);this.hintControlsInner.style.width=n+"px",this.hintControlsInner.style.height=r+"px",this.hintControlsInner.style.backgroundSize=n+"px "+5*r+"px",this.hintControlsInner.style.backgroundPosition="0px -"+r*a+"px";let o=Math.round(30*e),h=Math.floor(36*e);this.screenHint.style.fontSize=h+"px",this.hintText.innerHTML=this.hintShadow.innerHTML="",this.hintText.textContent=this.hintShadow.textContent=A;let m=-(r+o),l=m-o-r;this.screenHint.style.display="",this.screenHint.style.transition="",this.screenHint.style.transitionTimingFunction="",this.screenHint.style.top=l+"px",this.hintControls.style.display="",this.hintControls.style.transition="",this.hintControls.style.transitionTimingFunction="",this.hintControls.style.top=m+"px";let c="0.26s";setTimeout(()=>{i.screenHint.style.transition=c,i.screenHint.style.transitionTimingFunction="ease-out",i.screenHint.style.top="calc(46% - "+h+"px)",i.hintControls.style.transition=c,i.hintControls.style.transitionTimingFunction="ease-out",i.hintControls.style.top="calc(46% + "+o+"px)"},1),setTimeout(()=>{i.screenHint.style.transition=c,i.screenHint.style.transitionTimingFunction="ease-in",i.screenHint.style.top=l+"px",i.hintControls.style.transition=c,i.hintControls.style.transitionTimingFunction="ease-in",i.hintControls.style.top=m+"px",GameWrapper.characterAnimation=1,"function"==typeof t&&t()},1260),setTimeout(()=>{"function"==typeof s&&s()},1520)},characterImage:new Image,characterAnimation:1,characterFrame:0,characterInterval:null,characterScale:1,characterSteps:12,characterSize:{x:160,y:290},setCharacterImage:function(A){if(!BrowserHelper.isMobile()){if(!A.src||!A.naturalHeight)throw"Image not loaded!";this.characterImage=A,this.character.style.backgroundImage='url("'+this.characterImage.src+'")',this.startCharacterAnimation()}},startCharacterAnimation:function(){if(!BrowserHelper.isMobile()){let A=this;this.stopCharacterAnimation(),this.characterInterval=setInterval(function(){A.characterFrame++,2<A.characterFrame&&(A.characterFrame=1),A.updateCharacterAnimation()},Math.round(PWGame.msPerTargetFrame*this.characterSteps)),this.updateCharacterAnimation()}},stopCharacterAnimation:function(){BrowserHelper.isMobile()||this.characterInterval&&clearInterval(this.characterInterval)},setCharacterScale:function(A){var e;BrowserHelper.isMobile()||(e=this.layoutDesktop,this.characterSize.x=Math.round(e.characterFrameWidth*A),this.characterSize.y=Math.round(e.characterFrameHeight*A),this.character.style.backgroundSize=3*this.characterSize.x+"px "+2*this.characterSize.y+"px",this.characterScale=A)},updateCharacterAnimation:function(){var A=(this.characterFrame-1)*this.characterSize.y,e=(this.characterAnimation-1)*this.characterSize.x;this.character.style.backgroundPosition="-"+e+"px -"+A+"px"},logoImage:new Image,logoScale:1,logoSize:{x:320,y:180},setLogoImage:function(A){if(!BrowserHelper.isMobile()){if(!A.src||!A.naturalHeight)throw"Image not loaded!";this.logoImage=A,this.logo.style.backgroundImage='url("'+this.logoImage.src+'")'}},setLogoScale:function(A){var e;BrowserHelper.isMobile()||(e=this.layoutDesktop,this.logoSize.x=Math.round(e.logoWidth*A),this.logoSize.y=Math.round(e.logoHeight*A),this.logo.style.backgroundSize=this.logoSize.x+"px "+this.logoSize.y+"px",this.logoScale=A)},getWindowSize:function(){var A={orientation:"desktop"};let e=document.createElement("div");return e.style.cssText="position:fixed;width:100%;height:100%;top:0px;left:0px",document.body.appendChild(e),BrowserHelper.isMobile()&&(A.orientation=e.clientWidth>e.clientHeight?"landscape":"portrait"),window.screen.width>window.screen.height&&"portrait"==A.orientation||window.screen.width<window.screen.height&&"landscape"==A.orientation?(A.width=window.screen.height,A.height=window.screen.width):(A.width=window.screen.width,A.height=window.screen.height),A.ew=e.clientWidth,A.eh=e.clientHeight,e.parentNode.removeChild(e),A},updateGameScreenOrientation:function(){var A=GameWrapper.getWindowSize();"game"===this.view&&("landscape"===A.orientation?GameWrapper.viewGameMobileLandscape(A):"portrait"===A.orientation?GameWrapper.viewGameMobilePortrait(A):GameWrapper.viewGameDesktop(A),this.gameplaySkin.setAttribute("class","gameplay-skin "+A.orientation))}};class PWInput{static UP="up";static DOWN="down";static LEFT="left";static RIGHT="right";static ACTION="action";static PAUSE="pause";static inputImages={wasd:0,arrows:1,gamepad:2,mouse:3,touch:4};static#touchType="touch";static#gamepadType="gamepad";constructor(){let a=this;this.reset(),this.keyMap_arrows={up:"ArrowUp",left:"ArrowLeft",down:"ArrowDown",right:"ArrowRight",action:"Space",pause:"Escape"},this.keyMap_wasd={up:"KeyW",left:"KeyA",down:"KeyS",right:"KeyD",action:"Space",pause:"Escape"},this.setKeyMap("wasd"),document.addEventListener("keydown",function(A){for(var[e,t]of Object.entries(a.keyMap))if(A.code==t){PWInput.#gamepadType="wasd"===a.keymapName?"wasd":"arrows",PWInput.#touchType="mouse",a.setInputState(e,!0,A);break}}),document.addEventListener("keyup",function(A){for(var[e,t]of Object.entries(a.keyMap))if(A.code==t){a.setInputState(e,!1,A);break}}),BrowserHelper.isMobile()||(document.addEventListener("mousedown",function(A){PWInput.#touchType="mouse",PWInput.#gamepadType="wasd"===a.keymapName?"wasd":"arrows",0===A.button&&a.setInputState("action",!0,A)}),document.addEventListener("mouseup",function(A){0===A.button&&a.setInputState("action",!1,A)})),this.axisMap_standard={horiz:0,vert:1},this.buttonMap_standard={up:12,right:15,down:13,left:14,action:0,pause:9};var i=.25,n=1-i,r={buttons:[],axes:[]};requestAnimationFrame(function A(){var t=navigator.getGamepads();if(t&&t[0]){var s=t[0];let e;for(e=0;e<s.buttons.length;e++){void 0===r.buttons[e]&&(r.buttons[e]=0);let A=Math.abs(s.buttons[e].value)>i?s.buttons[e].value:0;A&&(A=0<A?A-i:A+i,A/=n),A!==r.buttons[e]&&(function(A,e){PWInput.#gamepadType="gamepad";for(var[t,s]of Object.entries(a.buttonMap_standard))if(A==s){a.setInputState(t,0<e);break}}(e,A),r.buttons[e]=A)}for(e=0;e<s.axes.length;e++){void 0===r.axes[e]&&(r.axes[e]=0);let A=Math.abs(s.axes[e])>i?s.axes[e]:0;A&&(A=0<A?A-i:A+i,A/=n),A!==r.axes[e]&&(function(A,e){if(PWInput.#gamepadType="gamepad",A===a.axisMap_standard.horiz){if(!e)return a.setInputState("left",!1),a.setInputState("right",!1);var t=0<e?"right":"left";a.setInputState(t,!0)}else if(A===a.axisMap_standard.vert){if(!e)return a.setInputState("up",!1),a.setInputState("down",!1);e=0<e?"down":"up",a.setInputState(e,!0)}}(e,A),r.axes[e]=A)}}requestAnimationFrame(A)})}getControlHint(A){return(A=A===PWInput.TYPE_GAMEPAD?PWInput.TYPE_GAMEPAD:PWInput.TYPE_TOUCH)===PWInput.TYPE_GAMEPAD?PWInput.#gamepadType:PWInput.#touchType}setKeyMap(A){this.keymapName=A,this.keyMap={};for(var[e,t]of Object.entries(this["keyMap_"+A]))this.mapKey(t,e)}mapKey(A,e){this.keyMap[e]=A}reset(){this.inputs={up:!1,right:!1,down:!1,left:!1,action:!1,pause:!1},this.justChanged={up:0,right:0,down:0,left:0,action:0,pause:0},this._onPress={},this._onPressThisArg={},this._onRelease={},this._onReleaseThisArg={},this._aliases={},this._alias_map={}}setAlias(e,A){let t=this;(A="string"==typeof A?[A]:A).forEach(A=>{t._aliases[A]||(t._aliases[A]=[]),t._aliases[A].indexOf(e)<0&&t._aliases[A].push(e)}),this._alias_map[e]=A}isDown(A){if(this._alias_map[A]){for(var e in this._alias_map[A])if(this.inputs[this._alias_map[A][e]])return!0;return!1}return void 0!==this.inputs[A]&&this.inputs[A]}justPressed(A){if(this._alias_map[A]){for(var e in this._alias_map[A])if(this.justPressed(this._alias_map[A][e]))return!0;return!1}var t=this.isDown(A)&&this.justChanged[A];return this.justChanged[A]&&clearTimeout(this.justChanged[A]),t}justReleased(A){if(this._alias_map[A]){for(var e in this._alias_map[A])if(this.justReleased(this._alias_map[A][e]))return!0;return!1}var t=!this.isDown(A)&&this.justChanged[A];return this.justChanged[A]&&clearTimeout(this.justChanged[A]),t}onPress(A,e,t){this._onPressThisArg[A]=void 0!==t?t:this,this._onPress[A]=e}onRelease(A,e,t){this._onReleaseThisArg[A]=void 0!==t?t:this,this._onRelease[A]=e}setInputState(A,t,s){if(this.checkInputState(A,t,s),this._aliases[A]){let e=this;this._aliases[A].forEach(function(A){e.checkInputState(A,t,s)})}}checkInputState(A,e,t){this.inputs[A]!==e&&(this.inputs[A]=e,this.justChanged[A]&&clearTimeout(this.justChanged[A]),this.justChanged[A]=setTimeout(()=>{},100),e&&this._onPress[A]?this._onPress[A].call(this._onPressThisArg[A],A,t):!e&&this._onRelease[A]&&this._onRelease[A].call(this._onReleaseThisArg[A],A,t))}onLayoutInputChanged(A){var e,t;for([e,t]of Object.entries(A))t!==this.inputs[e]&&this.setInputState(e,t,null)}}PWInput.TYPE_GAMEPAD="gamepad",PWInput.TYPE_TOUCH="touch";class PWLevel{static MODE_NORMAL="normal";static MODE_ENDLESS="endless";static MODE_BOSSRUSH="bossrush";#devMode=!1;get devMode(){return this.#devMode}#manifest={};get manifest(){return this.#manifest}#mode=PWLevel.MODE_NORMAL;get mode(){return this.#mode}#round=1;get round(){return this.#round}#lastRound=1;get lastRound(){return this.#lastRound}#bossRound=!1;get bossRound(){return this.#bossRound}#complete=!1;get complete(){return this.#complete}#difficulty=0;get difficulty(){return this.#difficulty}#lastDifficulty=0;get lastDifficulty(){return this.#lastDifficulty}__setDifficulty(A,e=!1){e||(this.#lastDifficulty=this.#difficulty),this.#difficulty=A=2<(A=A<0?0:A)?2:A,e&&(this.#lastDifficulty=this.#difficulty)}#microgameRounds=0;get microgameRounds(){return this.#microgameRounds}#gamesPerRound=0;get gamesPerRound(){return this.#gamesPerRound}#gamesRemaining=0;get gamesRemaining(){return this.#gamesRemaining}#microgameManifests=[];get microgameManifests(){return this.#microgameManifests}#microgameManifestsUsed=[];get microgameManifestsUsed(){return this.#microgameManifestsUsed}#bossgameManifests=[];get bossgameManifests(){return this.#bossgameManifests}#bossgameManifestsUsed=[];get bossgameManifestsUsed(){return this.#bossgameManifestsUsed}#score=0;get score(){return this.#score}#lastScore=0;get lastScore(){return this.#lastScore}#health=4;get health(){return this.#health}#lastHealth=4;get lastHealth(){return this.#lastHealth}#imgs={logo:null,character:null};get imgs(){return this.#imgs}constructor(A,e){if(this.__setDifficulty(0,!0),!A)throw"Missing required manifest!";if("object"!=typeof A)throw"Manifest must be an object!";var t;if("object"==typeof e&&(t={},Object.assign(t,A,e),A=t),A.devMode){this.#devMode=A.devMode;for(var[s,a]of Object.entries(PWLevel.default_manifest))void 0===A[s]&&(A[s]=a)}if(!A.character)throw"Missing required character!";if(!A.logo)throw"Missing required logo!";if(!A.transition)throw"Missing required transition!";if(A.mode===PWLevel.MODE_ENDLESS||A.mode===PWLevel.MODE_BOSSRUSH?this.#mode=A.mode:(this.#mode=PWLevel.MODE_NORMAL,A.difficulty&&0<A.difficulty&&A.difficulty<=3&&this.__setDifficulty(A.difficulty,!0)),this.mode!==PWLevel.MODE_BOSSRUSH){if(!A.microgames)throw"Missing required microgame array!";if(!A.bossgame&&A.mode===PWLevel.MODE_NORMAL)throw"Missing required bossgame!";if(A.microgames){if(!Array.isArray(A.microgames))throw"Microgames must be an array!";if(0===A.microgames.length)throw"Microgames array must have at least one item!";A.microgames.forEach(function(A,t){if(!A.numGames)throw"Microgame manifest["+t+"] missing numGames!";if(!A.gameList)throw"Microgame manifest["+t+"] missing gameList!";if(!Array.isArray(A.gameList))throw"Microgame manifest["+t+"] gameList is not an array!";if(0===A.gameList.length)throw"Microgame manifest["+t+"] gameList is empty!";A.gameList.forEach(function(A,e){if(!A.team)throw"Microgame manifest["+t+"]["+e+"] missing team property!";if(!A.game)throw"Microgame manifest["+t+"]["+e+"] missing game property!"})})}this.#microgameRounds=A.microgames.length,this.#gamesPerRound=A.microgames[0].numGames,this.#gamesRemaining=this.#gamesPerRound}this.#microgameManifests=[],this.#microgameManifestsUsed=[],this.#bossgameManifests=[],this.#bossgameManifestsUsed=[],this.#score=0,this.#lastScore=0,this.#health=4,this.#lastHealth=this.#health,this.#manifest=A,this.#imgs={logo:new Image,character:new Image}}getNext(t){let A=null;if(this.#mode!==PWLevel.MODE_BOSSRUSH){this.#lastRound=this.#round;let A=this.#round-1,e=void 0!==this.#manifest.microgames[A]?this.#manifest.microgames[A]:null;if(A<this.#microgameRounds){if(!e||0===e.length)return console.error("No microgames!"),void t("error","No microgames!");if(0<this.#gamesRemaining)this.#gamesRemaining--;else if(this.#round++,this.#round>=this.#microgameRounds&&this.#mode===PWLevel.MODE_ENDLESS&&(this.#round=1,this.#lastRound=0,this.__setDifficulty(0,!0)),A=this.#round-1,A<this.#microgameRounds)return e=this.#manifest.microgames[A],this.#gamesRemaining=e.numGames,void t("newround","microgame")}}else{if(this.#lastRound=this.#round,this.#bossgameManifests.length<1){if(2===this.difficulty)return this.__setDifficulty(0,!0),this.#round++,void t("newround","microgame");this.#bossgameManifests=this.#bossgameManifestsUsed,this.#bossgameManifestsUsed=[],this.__setDifficulty(this.difficulty+1,!1)}A=this.#bossgameManifests.splice(Math.floor(Math.random()*this.#bossgameManifests.length),1)[0],this.#bossgameManifestsUsed.push(A)}A?(this.#bossRound=!0,t("bossgame",A)):t("microgame",this.getRandomMicrogameManifest())}onGameComplete(A){this.game_complete_callback=A}gameCompleted(A){GameWrapper.characterAnimation=A?2:3,this.#lastScore=this.#score,this.#lastHealth=this.#health,this.#score++,A||this.#health--,this.bossRound&&this.#mode!==PWLevel.MODE_BOSSRUSH&&(this.complete=!0),this.game_complete_callback&&this.game_complete_callback(A)}preload(A,a){let i=this;var t=1;function n(){--t<1&&PWGame.preloadManifests(A)}function r(A){console.error(A),--t<1&&(console.error("Loaded with errors!"),alert("Loaded with errors!"))}let o=[];t++;let e=new Promise((A,e)=>{PWGame.loadTransition(i.#manifest.transition,function(){A()},function(A){console.error(A),alert("Transition Scene Failed:\n"+A+"\n\nCheck dev console for more information"),e()},void 0!==a&&a)});e.then(n,r),this.#manifest.microgames&&this.#manifest.microgames.forEach(function(A){A.gameList.forEach(function(s){var e=s.team+"/microgames/"+s.game;if(!(0<=o.indexOf(e))){o.push(e),t++;let A=new Promise((e,t)=>{PWGame.loadMicroGame(s,function(A){i.#microgameManifests.push(A),e()},function(A){console.error(A),alert("Microgame Failed:\n"+A+"\n\nCheck dev console for more info."),t()},void 0!==a&&a)});A.then(n,r)}})});let s=[];this.#manifest.bossgame?s.push(this.#manifest.bossgame):this.#manifest.bossgames&&(s=this.#manifest.bossgames),s&&s.forEach(function(s){var e=s.team+"/bossgames/"+s.game;if(!(0<=o.indexOf(e))){o.push(e),t++;let A=new Promise((e,t)=>{PWGame.loadBossGame(s,function(A){i.#bossgameManifests.push(A),e()},function(A){console.error(A),alert("Boss Game Failed:\n"+A+"\n\nCheck dev console for more info."),t()},void 0!==a&&a)});A.then(n,r)}}),t++,this.#imgs.logo=new Image,this.#imgs.logo.src="teams/"+this.#manifest.logo.team+"/logos/"+this.#manifest.logo.image,this.#imgs.logo.onload=n,t++,this.#imgs.charsheet=new Image,this.#imgs.charsheet.src="teams/"+this.#manifest.character.team+"/characters/"+this.#manifest.character.sheet,(this.#imgs.charsheet.onload=n)()}hasIntro(){return!1}getRandomMicrogameManifest(){if(!this.#manifest.microgames||0===this.#manifest.microgames.length)return!1;if(this.#microgameManifests.length<1&&(this.#microgameManifests=this.#microgameManifestsUsed,this.#microgameManifestsUsed=[]),this.#microgameManifests.length<1)throw"Level has no microgame manifests loaded";var A=this.#microgameManifests.splice(Math.floor(Math.random()*this.#microgameManifests.length),1)[0];return this.#microgameManifestsUsed.push(A),A}getBossgameManifest(){return this.#manifest.bossgame||!1}}PWLevel.default_manifest={difficulty:0,mode:PWLevel.MODE_NORMAL,logo:{team:"psychogoldfish",image:"sir_reginald_emojiman.png"},character:{team:"psychogoldfish",sheet:"sir_reginald_emojiman_sheet.webp",icon:"sir_reginald_emojiman_icon.png"},transition:{team:"psychogoldfish",name:"emojis"},microgames:null,bossgame:null};class PWTransitionScene extends Phaser.Scene{static PHASE_START="start";static PHASE_INFO="info";static PHASE_EXIT="exit";static PHASE_ENTER="enter";static PHASE_FASTER="faster";static PHASE_LEVEL_UP="level-up";static PHASE_BOSS_LEVEL="boss-game";static PHASE_GAME_OVER="game-over";static PHASE_WINNER="winner";constructor(A){super(A);let e=!1;if("function"!=typeof this.enter&&(e="You must add an enter(transition_name) method to your transition scene. The framework will call this to show the enter-in transition."),e)throw alert("ERROR: "+e),e}}class PWGameSceneloader extends Phaser.Scene{constructor(A){super({key:A||"PWGameSceneloader"})}preload(){let n=this;function r(A,e){let t=e;return A.team&&(t="teams/"+A.team+"/",A.microgame?t+="microgames/"+A.microgame+"/":A.bossgame?t+="bossgames/"+A.bossgame+"/":A.transition&&(t+="transitions/"+A.transition+"/")),t}this.load.on("progress",function(A){PWGame.onManifestsLoaded(A)}),PWGameSceneloader.manifests.forEach(a=>{let i=a.prefix||a.sceneClass+".";a.images&&a.images.forEach(A=>{var e=A.key||A.image,t=r(A,a.path),s={key:i+e,url:t+A.image};void 0!==A.normalMap&&(A.normalMap=t+A.normalMap),n.load.image(s),PWGame.textureTypes[i+e]="image"}),a.spritesheets&&a.spritesheets.forEach(A=>{var e=A.key||A.image,t=r(A,a.path);let s={key:i+e,url:t+A.image,frameConfig:{frameWidth:A.frameWidth,frameHeight:A.frameHeight}};void 0!==A.startFrame&&(s.frameConfig.startFrame=A.startFrame),void 0!==A.endFrame&&(s.frameConfig.endFrame=A.endFrame),void 0!==A.margin&&(s.frameConfig.margin=A.margin),void 0!==A.spacing&&(s.frameConfig.spacing=A.spacing),void 0!==A.normalMap&&(A.normalMap=t+A.normalMap),n.load.spritesheet(s),PWGame.textureTypes[i+e]="spritesheet"}),a.atlases&&a.atlases.forEach(A=>{var e=A.key||A.texture,t=r(A,a.path),s={key:i+e,textureURL:t+A.texture,atlasURL:t+A.atlas};void 0!==A.normalMap&&(A.normalMap=t+A.normalMap),n.load.atlas(s),PWGame.textureTypes[i+e]="atlas"})})}}PWGameSceneloader.loaded={},PWGameSceneloader.manifests=[];class PWFramework{static USERMODE_PROD="prod";static USERMODE_DEBUG="debug";static USERMODE_DEV="dev";#phaser=null;get phaser(){return this.#phaser}textureTypes={};#usermode=PWFramework.USERMODE_PROD;get usermode(){return this.#usermode}#screenSize=524;get screenSize(){return this.#screenSize}#screen=null;get screen(){return this.#screen}#paused=!1;get paused(){return this.#paused}#inTransition=!1;get inTransition(){return this.#inTransition}#targetFPS=60;get targetFPS(){return this.#targetFPS}#gameSpeed=1;get gameSpeed(){return this.#gameSpeed}#newGame=!0;get newGame(){return this.#newGame}#newLevel=!0;get newLevel(){return this.#newLevel}#msPerTargetFrame=0;get msPerTargetFrame(){return this.#msPerTargetFrame}#msPerStep=0;get msPerStep(){return this.#msPerStep}#stepTracker=0;get stepTracker(){return this.#stepTracker}#input=new PWInput;get input(){return this.#input}#activeGameScene=null;get activeGameScene(){return this.#activeGameScene}#activeTransition=null;get activeTransition(){return this.#activeTransition}#winOnTimeUp=!1;get winOnTimeUp(){return this.#winOnTimeUp}constructor(){this.onManifestsLoaded=()=>{},this.setGameSpeed(this.gameSpeed)}start(A=PWFramework.USERMODE_PROD){if(-1===[PWFramework.USERMODE_PROD,PWFramework.USERMODE_DEBUG,PWFramework.USERMODE_DEV].indexOf(A))throw"Invalid usermode: "+A;this.#usermode=A;let e=this;GameWrapper.init({onScreenUpdated:this.onScreenUpdated,onScreenUpdatedThisArg:this,onInputChanged:this.#input.onLayoutInputChanged,onInputChangedThisArg:this.#input}),this.baseScene=new Phaser.Scene("___baseScene___"),this.baseScene.create=function(){e.phaser.scene.add("___loaderScene___",e.loaderScene),e.#usermode===PWFramework.USERMODE_DEV?e.startDevScreen():(console.error("This mode isn't supported yet!"),alert("This mode isn't supported yet!"))},this.loaderScene=new PWGameSceneloader("___loaderScene___"),this.#phaser=new Phaser.Game({parent:"screen",type:Phaser.AUTO,width:this.#screenSize,height:this.#screenSize,id:"PhaserCanvas",backgroundColor:"#000000",scene:[this.baseScene],physics:{default:"arcade",arcade:{gravity:{y:0},debug:!!localStorage.getItem("debug-physics")}}})}onScreenUpdated(A){this.#screen=A,this.phaser&&this.phaser.canvas&&(this.phaser.canvas.style.width=A.size+"px",this.phaser.canvas.style.height=A.size+"px")}startDevScreen(){let e=this,A,t=document.getElementById("dev-interface");t.onclick=function(A){A.stopPropagation()};let s=document.getElementById("debug-physics");A=localStorage.getItem("debug-physics"),A&&(s.checked=!0),s.onchange=function(){s.checked?localStorage.setItem("debug-physics","true"):localStorage.removeItem("debug-physics"),location.reload()};let a=document.getElementById("microgame-team");A=localStorage.getItem("microgame-team"),A&&(a.value=A);let i=document.getElementById("microgame-dir");A=localStorage.getItem("microgame-dir"),A&&(i.value=A);let n=document.getElementById("microgame-btn"),r=document.getElementById("bossgame-team");A=localStorage.getItem("bossgame-team"),A&&(r.value=A);let o=document.getElementById("bossgame-dir");A=localStorage.getItem("bossgame-dir"),A&&(o.value=A);let h=document.getElementById("bossgame-btn");function m(A){return 4!==(A=A.split("/")).length?(console.error("Invalid path!",A),!1):[A[1],A[3]]}t.style.display="",this.phaser.canvas.style.display="none",GameWrapper.gameplaySkin.style.display="none",GameWrapper.fadeIn(),n.onclick=function(A){if(0,localStorage.setItem("microgame-team",a.value),localStorage.setItem("microgame-dir",i.value),A.preventDefault(),A.stopPropagation(),m("teams/"+a.value+"/microgames/"+i.value)){let A={mode:PWLevel.MODE_ENDLESS,microgames:[{numGames:3,gameList:[{team:a.value,game:i.value}]}],devMode:"game"};t.style.pointerEvents="none",GameWrapper.crossFade(function(){t.style.display="none",t.style.pointerEvents="",e.startLevel(A)})}},h.onclick=function(A){if(0,localStorage.setItem("bossgame-team",r.value),localStorage.setItem("bossgame-dir",o.value),A.preventDefault(),A.stopPropagation(),m("teams/"+r.value+"/bossgames/"+o.value)){let A={mode:PWLevel.MODE_BOSSRUSH,bossgames:[{team:r.value,game:o.value}],devMode:"bossgame"};t.style.pointerEvents="none",GameWrapper.crossFade(function(){t.style.display="none",t.style.pointerEvents="",e.startLevel(A)})}}}startLevel(e){this.#inTransition=!0;let t=this;this.level=new PWLevel(e),this.#newLevel=!0,this.showGameLayout(),GameWrapper.showLoadScreen(),GameWrapper.setLoadedValue(0),this.level.preload(function(A){GameWrapper.setLoadedValue(A),1===A&&GameWrapper.crossFade(()=>{GameWrapper.hideLoadScreen(),GameWrapper.setCharacterImage(t.level.imgs.charsheet),GameWrapper.setLogoImage(t.level.imgs.logo),t.#activeTransition="transitions."+e.transition.team+"."+e.transition.name,t.level.hasIntro()?t.level.playIntro(function(){t.nextPhase()}):t.nextPhase()})},!0),this.level.onGameComplete(function(){t.nextPhase(!0)})}showGameLayout(){GameWrapper.updateGameScreenOrientation(),GameWrapper.gameplaySkin.style.display="",this.phaser.canvas.style.display=""}transitionIn(A,e){A?setTimeout(e,3e3):e()}nextPhase(a){let i=this;this.level.getNext(function(A,e){let t=null,s=null;switch(i.#inTransition=!0,A){case"bossgame":s="Boss Level!",t=e;break;case"microgame":i.level.mode!==PWLevel.MODE_ENDLESS||i.newLevel||i.level.__setDifficulty(i.level.difficulty+1),t=e;break;case"newround":i.increaseGameSpeed(),s="Faster!";break;case"finish":s="devmode"===e?"Test Complete!":"You Win!"}t?i.nextGame(t,a):s&&i.showTransactionScene(PWTransitionScene.PHASE_NEXT_GAME),i.#newGame=!1});i.#newLevel=!1}nextGame(A,e){this.activeManifest=A,this.showTransactionScene(e?PWTransitionScene.PHASE_NEXT_GAME:PWTransitionScene.PHASE_START)}stopGame(){this.#activeGameScene&&this.phaser.scene.stop(this.#activeGameScene)}endTransition(){this.#inTransition=!1,this.#activeTransition&&this.phaser.scene.stop(this.#activeTransition),this.level.bossRound||GameWrapper.startGameTimer()}showHints(A,e){let t="Get Ready!",s="gamepad",a=this.phaser.scene.getScene(this.#activeGameScene);a&&(a.getHintText&&(t=a.getHintText()),a.getControls&&(s=a.getControls())),GameWrapper.setHintText(t,s,A,e)}startGame(){this.startActualGame(this.activeManifest),this.#msPerStep=this.msPerTargetFrame*PWConfig.FRAMES_PER_STEP,this.#stepTracker=0,GameWrapper.startCharacterAnimation()}showTransactionScene(A){this.phaser.scene.isActive(this.#activeTransition)||this.phaser.scene.start(this.#activeTransition),this.phaser.scene.bringToTop(this.#activeTransition);let e=this.phaser.scene.getScene(this.#activeTransition);e.enter(A)}startActualGame(A){this.#newGame=!0,this.#input.reset(),this.#activeGameScene=A.sceneClass,this.phaser.scene.start(this.#activeGameScene)}queuePreloadManifests(A,e=0){A.forEach(A=>{PWGameSceneloader.manifests.push(A)})}doLoadManifest(A,s,a,i,n){function e(){let e=[];if(A.forEach(function(A){void 0===s[A]&&e.push("Missing required property in manifest.json: '"+A+"'")}),0<e.length)n(e.join("\n"));else{let t;try{t=r.getSceneClass(s.sceneClass)}catch(A){t=null}if(t)r.registerScene(t,s),r.queuePreloadManifests([s]),i(s);else{let e=s.jsFiles.length;s.jsFiles.forEach(A=>{loaderScript(a+A).then(()=>{if(e--,e<=0)try{t=r.getSceneClass(s.sceneClass),r.registerScene(t,s),r.queuePreloadManifests([s]),i(s)}catch(A){n(A)}}).catch(A=>{console.error(A),n(A)})})}}}var t,r=this;s.parent?(t=_Manifests[s.type][s.parent.team][s.parent.name],this.doLoadManifest(A,t,t.path,e,n)):e()}loadTransition(A,t,s,e){let a=this;this.loadTransitionManifest(A,function(A,e){a.doLoadManifest(["name","jsFiles","sceneClass"],A,e,t,s)},s,e)}loadMicroGame(A,t,s,e){let a=this;!0===s&&(e=!0,s=function(){}),s=void 0!==s?s:function(A){console.error(A),alert(A)},this.loadMicroGameManifest(A,function(A,e){a.doLoadManifest(["name","jsFiles","sceneClass"],A,e,t,s)},s,e)}loadBossGame(A,t,s,e){let a=this;!0===s&&(e=!0,s=function(){}),s=void 0!==s?s:function(A){console.error(A),alert(A)},this.loadBossGameManifest(A,function(A,e){a.doLoadManifest(["name","jsFiles","sceneClass"],A,e,t,s)},s,e)}preloadManifests(A){this.onManifestsLoaded=void 0!==A?A:function(){},this.manifestPreloadQueue=[],this.phaser.scene.start("___loaderScene___")}loadTransitionManifest(t,s,a,i){let n=this;_Manifests.transitions[t.team]=void 0!==_Manifests.transitions[t.team]?_Manifests.transitions[t.team]:{},!0===a&&(i=!0,a=function(){}),a=void 0!==a?a:function(A){console.error(A),alert(A)};let r="teams/"+t.team+"/transitions/"+t.name+"/";var A;i||!_Manifests.transitions[t.team][t.name]?this.getJSON(r+"manifest.json",function(A){A.path=r,A.type="transitions";function e(){_Manifests.transitions[t.team][t.name]=A,s(_Manifests.transitions[t.team][t.name],r)}A.parent&&A.parent.team&&A.parent.name?n.loadTransitionManifest({team:A.parent.team,name:A.parent.name},e,a,i):e()},function(A){console.error(A),console.error("Couldn't find file: "+r+"/manifest.json"),a("Could not load transition at team: "+t.team+", name: "+t.name)}):(A=function(){_Manifests.transitions[t.team][t.name].path=r,_Manifests.transitions[t.team][t.name].type="transitions",s(_Manifests.transitions[t.team][t.name],r)},data.parent&&data.parent.team&&data.parent.name?n.loadTransitionManifest({team:data.parent.team,name:data.parent.name},A,a,i):A())}loadMicroGameManifest(t,s,a,i){let n=this;_Manifests.microgames[t.team]=void 0!==_Manifests.microgames[t.team]?_Manifests.microgames[t.team]:{},!0===a&&(i=!0,a=function(){}),a=void 0!==a?a:function(A){console.error(A),alert(A)};let r="teams/"+t.team+"/microgames/"+t.game+"/";var A;i||!_Manifests.microgames[t.team][t.game]?this.getJSON(r+"manifest.json",function(A){A.path=r,A.type="microgames";function e(){_Manifests.microgames[t.team][t.game]=A,s(_Manifests.microgames[t.team][t.game],r)}A.parent&&A.parent.team&&A.parent.name?n.loadMicroGameManifest({team:A.parent.team,game:A.parent.name},e,a,i):e()},function(A){console.error(A),console.error("Couldn't find file: "+r+"/manifest.json"),a("Could not load game at team: "+t.team+", game: "+t.game)}):(A=function(){_Manifests.microgames[t.team][t.game].path=r,_Manifests.microgames[t.team][t.game].type="microgames",s(_Manifests.microgames[t.team][t.game],r)},data.parent&&data.parent.team&&data.parent.name?n.loadMicroGameManifest({team:data.parent.team,game:data.parent.name},A,a,i):A())}loadBossGameManifest(t,s,a,i){let n=this;_Manifests.bossgames[t.team]=void 0!==_Manifests.bossgames[t.team]?_Manifests.bossgames[t.team]:{},!0===a&&(i=!0,a=function(){}),a=void 0!==a?a:function(A){console.error(A),alert(A)};let r="teams/"+t.team+"/bossgames/"+t.game+"/";var A;i||!_Manifests.bossgames[t.team][t.game]?this.getJSON(r+"manifest.json",function(A){A.path=r,A.type="bossgames";function e(){_Manifests.bossgames[t.team][t.game]=A,s(_Manifests.bossgames[t.team][t.game],r)}A.parent&&A.parent.team&&A.parent.name?n.loadBossGameManifest({team:A.parent.team,game:A.parent.name},e,a,i):e()},function(A){console.error(A),console.error("Couldn't find file: "+r+"/manifest.json"),a("Could not load game at team: "+t.team+", game: "+t.game)}):(A=function(){_Manifests.bossgames[t.team][t.game].path=r,_Manifests.bossgames[t.team][t.game].type="bossgames",s(_Manifests.bossgames[t.team][t.game],r)},data.parent&&data.parent.team&&data.parent.name?n.loadBossGameManifest({team:data.parent.team,game:data.parent.name},A,a,i):A())}getJSON(A,e,t,s){"function"==typeof e&&(s=t,t=e,e=null),t=void 0!==t?t:function(){},s=void 0!==s?s:function(A){console.error(A),alert(A)},this.get(A,e,function(A){try{var e=JSON.parse(A);t(e)}catch(A){s(A)}},s)}get(A,e,t,s){if("function"==typeof e&&(s=t,t=e,e=null),t="function"==typeof t?t:function(){},s=void 0!==s?s:function(A){console.error(A),alert(A)},e&&"object"==typeof e){let A=[];for(var[a,i]of Object.entries(e))A.push(encodeURIComponent(a)+"="+encodeURIComponent(i));e="?"+A.join("&")}else e="";var n=new XMLHttpRequest;n.onreadystatechange=function(){4==this.readyState&&(200==this.status?t(this.responseText):s(this.responseText,this.status))},n.open("GET",A+e,!0),n.send()}registerScene(A,e){PWGameSceneloader.loaded[e.sceneClass]||(PWGameSceneloader.loaded[e.sceneClass]=A,this.phaser.scene.add(e.sceneClass,new A))}getSceneClass(A){let e=null,t=[],s=A.split(".");var a=s.shift();if("microgames"===a)e=microgames;else if("bossgames"===a)e=bossgames;else{if("transitions"!==a)throw"Scene class must be namespaced to transitions, microgames or bossgames!";e=transitions}for(t.push(a);0<s.length;){var i=s.shift();if(t.push(i),e=void 0!==e[i]?e[i]:null,!e)throw t.join(".")+" is undefined."}if(e.prototype instanceof Phaser.Scene)return e;throw A+" is either not an extension of Phaser.Scene, or there are errors in the class file."}isReady(){let A=this.phaser.scene.getScene(this.#activeGameScene);return A.scene.isActive()&&!this.inTransition&&!this.paused}togglePause(){return this.paused?this.resume():this.pause(),this.paused}pause(){this.#paused=!0,this.phaser.pause()}resume(){this.#paused=!1,this.phaser.resume()}setGameSpeed(A){this.#gameSpeed=A,this.#msPerTargetFrame=1e3/(this.targetFPS*A),this.#msPerStep=this.msPerTargetFrame*PWConfig.FRAMES_PER_STEP}increaseGameSpeed(){this.setGameSpeed(this.gameSpeed+PWConfig.SPEED_MODIFIER)}getDeltaMultiplier(A,e=!0){return e&&!this.level.bossRound&&this.sendDelta(A),A/this.msPerTargetFrame}sendDelta(A){GameWrapper.gameTimerStep<GameWrapper.gameTimerSteps+1&&(this.#stepTracker+=A,this.#stepTracker>=this.#msPerStep&&(this.#stepTracker-=this.#msPerStep,GameWrapper.gameTimerStep++,GameWrapper.gameTimerStep===GameWrapper.gameTimerSteps?GameWrapper.stopGameTimer():GameWrapper.gameTimerStep>GameWrapper.gameTimerSteps?this.level.gameCompleted(this.#winOnTimeUp):GameWrapper.updateGameTimerFrame()))}lostGame(A=!1){!0===A&&(GameWrapper.characterAnimation=3),this.#winOnTimeUp=!1}wonGame(A=!1){!0===A&&(GameWrapper.characterAnimation=2),this.#winOnTimeUp=!0}}const microgames={},bossgames={},transitions={},levels={},PWConfig={SPEED_MODIFIER:.25,FRAMES_PER_STEP:20},PWGame=new PWFramework;